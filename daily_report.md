### 2025/09/25 SQL操作（JOINと集計）

#### 実施内容
* **テーブル結合とデータ集計の利用**：`JOIN`句、集計関数、`GROUP BY`句を用いたデータ操作。
* **集計処理におけるエラー解決**：`ORA-00979`および`ORA-00937`エラーの根本原因分析と解決。
* **絞り込み条件の適用**：`HAVING`句を用いたグループ化後のデータ抽出。

#### 課題と解決（集計処理の壁）

1.  **ORA-00979 (GROUP BYの指定不足)**
    * **現象**: `GROUP BY`句を記述したにも関わらず、集計に必要なカラムが不足しているというエラーが発生。
    * **原因**: `SELECT`句で指定した非集約カラム（集計関数に含まれないカラム）が、すべて`GROUP BY`句に含まれていなかったため。
    * **解決**: `SELECT`句の内容と照らし合わせ、不足していた非集約カラムを追加し、**集計と非集計のバランス**を正しく取ることで解決。

2.  **ORA-00937 (GROUP BYの記述漏れ)**
    * **現象**: 単一カラムとグループ関数を同時に表示しようとした際、SQLがどのグループで集計すべきかを判断できずにエラーが発生。
    * **原因**: 集約関数と非集約カラムを混在させているにもかかわらず、**`GROUP BY`句そのものが抜けていた**ため。
    * **解決**: エラーメッセージから`GROUP BY`句の不足を確認し、非集約カラムを指定することで、どの単位で集計するかを明確にした。

#### 学びと考察

* **SQLの基本原則の再認識**: 今回の連続したエラー（`ORA-00979`, `ORA-00937`）から、SQLの集計処理における**「集約関数と非集約カラムの共存には、必ず`GROUP BY`が必要」**という基本原則を深く理解できた。
* **クエリ設計の意識**: `JOIN`と`GROUP BY`を組み合わせた複雑なクエリを書く中で、**「実現したいこと」を正確に言語化し、正しいSQL文に落とし込む力**の重要性を痛感した。
* **`HAVING`句の役割**: `COUNT(EXPENSE) > 1`などの具体例を通じて、`WHERE`がレコードの絞り込み、`HAVING`が**グループ化された結果の絞り込み**に使うという違いを明確に把握した。
* **ユーザビリティへの配慮**: 今後は、出力結果を見る側の視点を意識し、**`AS`句（エイリアス）**を使ってカラム名を分かりやすく命名する工夫や、**`ORDER BY`句**によるカラムの表示順序を意識したクエリ設計を心がける。

### 2025/09/24 SQL操作とトラブルシューティング

#### 実施内容
* Oracle SQL Developerの基本的な操作（接続パネルの再表示）
* SQLにおけるカラムの削除方法
* `ORA-01400`エラーの解決と原因分析
* `INSERT`文によるデータの追加

#### 課題と解決

1.  **ツールの操作ミス**: 接続パネルを誤って削除。
    * **解決**: メニューから再表示することで解決。ツールの基本的なUI操作を把握しておくことの重要性を再認識した。
2.  **必須列の指定漏れによるエラー**: `ORA-01400`エラーが発生。
    * **原因**: `INSERT`文で、必須列（`NOT NULL`）を指定していなかったため。
    * **解決**: `INSERT`前に `DESCRIBE` コマンドでテーブル構造を確認する習慣をつけることで、必須列を漏れなく指定するようにした。
3.  **データ表示順の誤解**: `INSERT`したデータがテーブルの末尾ではなく、先頭に表示されるという現象。
    * **原因**: SQLのテーブルに物理的な「上」「下」の概念はない。表示順はデータベースの最適化によって決まるため、特定の順序で表示するには `SELECT ... ORDER BY ...` を使用する必要がある。
    * **学び**: `INSERT`はデータを追加するだけであり、表示順は `SELECT` 文で制御するという、基本的な概念を深く理解できた。

### 2025/09/21 SQL操作とデータ移行

#### 実施内容
* 既存テーブルから新規テーブルへのデータ移行
* `UPDATE`文を使ったデータ更新と、データの整合性確保
* 複数のテーブル結合と`WHERE`句による複雑なデータ抽出

#### 課題と解決
1.  **データの自動採番**: Oracleデータベースには自動採番機能がないことを把握しておらず、データの挿入に苦戦。
    * **解決**: シーケンス（Sequence）を作成し、`NEXTVAL`を使って連番を生成することで対応。
2.  **データ移行と更新**: 既存テーブルから値を取り出して別のテーブルに挿入する際、構文理解が不十分だったため時間がかかりました。
    * **解決**: SQLの基本構文（`INSERT INTO ... SELECT ...`）を見直し、正しい構文を記述することで解決。
3.  **UPDATE文の更新対象**: `UPDATE`文使用時に、データの型不一致やエイリアスの指定漏れにより、意図しないデータ更新が発生。
    * **解決**: **データの型**と**エイリアス**を厳密に意識して記述することで、更新対象を明確にし、間違いを防ぎました。

#### 学び
* データベースのバージョンや種類（今回の場合はOracle）によって、構文や機能に違いがあることを再認識。
* **SQLの基本構文**は、複雑な処理を行う上で土台となりそうなので、常に基礎に立ち返ることが重要そうだと思いました。
* 実践的なSQLスキルを身につけるには、多様な結合方法と`WHERE`句の組み合わせを**繰り返し練習**し、**「何をしたいか」をSQL文で表現する力**を養う必要があると思いました。練習できるサイトをいくつか見つけたので、そちらを活用していく方向にします。

# 2025/09/20 SQL操作とトラブルシューティング

## 実施内容

* 既存テーブルへのデータ追加・修正作業
* 意図しないデータのクリーニング
* 複数のテーブルを関連付けた `UPDATE` 文の実行

## 課題と解決

1.  **意図しないデータの追加**: 誤ってデータを追加してしまったため、`DELETE`文を使ってデータのクリーニングを実施した。SQL操作におけるリスク管理と、`ROLLBACK`の重要性を再認識した。
2.  **テーブル関連付けにおける `UPDATE` 文**: 
    -   複数のテーブルを紐付けて一意のIDを更新する課題で苦戦。
    -   原因は、**Oracleデータベースにおける特定の構文**と、`FROM`・`WHERE`句の理解不足だった。
    -   最終的には、インターネット検索と公式ドキュメントを参照し、正しいSQL文を記述することで解決。

## 今後の学習方針

-   `FROM`・`WHERE`句など、SQLの基礎文法を「メモで済ませる」のではなく、**「自力で書けるようになる」**まで繰り返し演習する。
-   今回の経験から、実践的な学習においては、バージョンや環境による構文の違いを意識し、公式ドキュメントを確認する習慣を身につける。